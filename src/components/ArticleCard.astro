---
import { Icon } from 'astro-icon/components';
import type { CollectionEntry } from 'astro:content';
import { formatDate } from '../utils/date';
import { getWordCount } from '../utils/markdown';

interface Props {
  article: CollectionEntry<'posts'>;
}

const { article } = Astro.props;
const { title, description, publishedAt, category } = article.data;

const categoryMap: Record<string, string> = {
    'tech': '技术',
    'essay': '随笔',
    'project': '项目'
};

const wordCount = getWordCount(article.body);
---

<a href={`/posts/${article.slug}`} class="block bg-white dark:bg-dark-800 rounded-xl overflow-hidden shadow-sm dark:shadow-lg border border-gray-100 dark:border-white/5 hover:border-primary-500/30 transition-all duration-300 group flex flex-col mb-6 no-underline">
  <div class="p-6 md:p-8">
    
    <!-- Title Area with Accent -->
    <div class="relative pl-4 mb-4">
        <div class="absolute left-0 top-1.5 bottom-1.5 w-1 bg-primary-500 rounded-full"></div>
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            {title}
        </h2>
    </div>

    <!-- Metadata Row -->
    <div class="flex flex-wrap items-center gap-4 text-xs text-gray-500 dark:text-gray-400 mb-6 font-medium">
        <span class="flex items-center gap-1.5">
            <Icon name="ri:calendar-line" class="text-primary-500" />
            {formatDate(publishedAt)}
        </span>
        <span class="flex items-center gap-1.5">
            <Icon name="ri:folder-line" class="text-primary-500" />
            {categoryMap[category]}
        </span>
        <span class="flex items-center gap-1.5">
            <Icon name="ri:file-text-line" class="text-primary-500" />
            {wordCount} 字
        </span>
    </div>
    
    <!-- Divider -->
    <div class="h-px w-full bg-gray-100 dark:bg-white/5 mb-6"></div>

    <!-- Description (Preview) -->
    <p class="text-gray-600 dark:text-gray-300 text-base leading-relaxed mb-4">
        {description}
    </p>

     <!-- Expand Hint -->
    <div class="flex justify-center mt-2">
         <div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 text-sm font-medium flex items-center gap-1 transition-transform duration-300 group-hover:translate-y-1">
            阅读全文 <Icon name="ri:arrow-right-line" class="text-xl" />
        </div>
    </div>
  </div>
</a>
