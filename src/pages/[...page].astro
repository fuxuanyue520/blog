---
import PageLayout from '../layouts/PageLayout.astro';
import ArticleCard from '../components/ArticleCard.astro';
import Pagination from '../components/Pagination.astro';
import { getAllArticles } from '../utils/markdown';
import { Icon } from 'astro-icon/components';

export async function getStaticPaths({ paginate }: { paginate: any }) {
  const posts = await getAllArticles();
  return paginate(posts, { pageSize: 5 });
}

const { page } = Astro.props;
---

<PageLayout title="秋兰以为佩的博客">
    <div class="mb-4 flex items-center justify-between">
        <h2 class="text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2">
            <span class="w-1 h-5 bg-primary-500 rounded-full"></span>
            最新文章
        </h2>
        <span class="text-xs text-gray-500 dark:text-gray-400 hidden md:block">
            共 {page.total} 篇文章
        </span>
    </div>

    <div class="space-y-4">
        {page.data.map((post: any) => (
            <ArticleCard article={post} />
        ))}
    </div>
    
    <!-- New Pagination Component -->
    <Pagination 
        currentPage={page.currentPage} 
        lastPage={page.lastPage} 
        prevUrl={page.url.prev} 
        nextUrl={page.url.next} 
    />
</PageLayout>
